<!DOCTYPE html>
<html lang="ja">
    <head>
        <!--https://csshtml.work/click-button/ å‚è€ƒã«ã—ãŸãƒœã‚¿ãƒ³ã®ä½œã‚Šæ–¹ã€‚ã‚ã‚ŠãŒã¨ã†ï¼-->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="style.css" rel="stylesheet"/>
        <script src="js/main.js"></script>
        <script src="js/pokeReport.js"></script>
        <script src="js/pokedex2.js"></script>

        <title>ãƒ¬ãƒãƒ¼ãƒˆ(ä»®)v0.1.5c</title>

    </head>


    <body>
        <div id="page_link">
            <a href = "./index.html"><img src="img/pages/pokedex.png"></a>
            <a href = "./sleep.html"><img src="img/pages/sleep.png"></a>
            <a href = "./cook.html"><img src="img/pages/cook.png"></a>            
            <a href = "./report.html" class ="current"><img src="img/pages/report.png"></a>
        </div>

        <div id="input_form">
            <strong> Myãƒã‚±ãƒ¢ãƒ³ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ v2:</strong><br>
            <select id="input_mypoke_name" style="width:10em; font-size:1em" onclick="initializePokeList()" onchange="setFoodImages(this)"></select>
            Lv<select id="input_mypoke_lv" style="width:4em; font-size:1em" onclick="initializePokeList()"></select>

            <img id="input_mypoke_food_1" src="" dir="img/food/" class="ex-tiny" style="vertical-align: bottom;" onclick="toggleFood(this)">
            <img id="input_mypoke_food_2" src="" dir="img/food/" class="ex-tiny" style="vertical-align: bottom;" onclick="toggleFood(this)">
            <img id="input_mypoke_food_3" src="" dir="img/food/" class="ex-tiny" style="vertical-align: bottom;" onclick="toggleFood(this)">
            <br>
            <select id="input_mypoke_char" style="width:15.5em; font-size:1em">
                <option value="">--ã›ã„ã‹ãã‚’é¸æŠ--</option>
                <option value="å¯‚">ã•ã¿ã—ãŒã‚Š (é€Ÿâ†‘å…ƒâ†“)</option>
                <option value="ã„">ã„ã˜ã£ã±ã‚Š (é€Ÿâ†‘é£Ÿâ†“)</option>
                <option value="ã‚„">ã‚„ã‚“ã¡ã‚ƒ (é€Ÿâ†‘ã‚¹â†“)</option>
                <option value="å‹‡">ã‚†ã†ã‹ã‚“ (é€Ÿâ†‘Eâ†“)</option>
                <option value="ãš">ãšã¶ã¨ã„ (å…ƒâ†‘é€Ÿâ†“)</option>
                <option value="ã‚">ã‚ã‚“ã±ã (å…ƒâ†‘é£Ÿâ†“)</option>
                <option value="èƒ½">ã®ã†ã¦ã‚“ã (å…ƒâ†‘ã‚¹â†“)</option>
                <option value="ã®">ã®ã‚“ã (å…ƒâ†‘Eâ†“)</option>
                <option value="ã²">ã²ã‹ãˆã‚ (é£Ÿâ†‘é€Ÿâ†“)</option>
                <option value="ãŠ">ãŠã£ã¨ã‚Š (é£Ÿâ†‘å…ƒâ†“)</option>
                <option value="ã†">ã†ã£ã‹ã‚Šã‚„ (é£Ÿâ†‘ã‚¹â†“)</option>
                <option value="å†·">ã‚Œã„ã›ã„ (é£Ÿâ†‘Eâ†“)</option>
                <option value="ç©">ãŠã ã‚„ã‹ (ã‚¹â†‘é€Ÿâ†“)</option>
                <option value="å¤§">ãŠã¨ãªã—ã„ (ã‚¹â†‘å…ƒâ†“)</option>
                <option value="æ…">ã—ã‚“ã¡ã‚‡ã† (ã‚¹â†‘é£Ÿâ†“)</option>
                <option value="ãª">ãªã¾ã„ã (ã‚¹â†‘Eâ†“)</option>
                <option value="è‡†">ãŠãã³ã‚‡ã† (Eâ†‘é€Ÿâ†“)</option>
                <option value="ã›">ã›ã£ã‹ã¡ (Eâ†‘å…ƒâ†“)</option>
                <option value="é™½">ã‚ˆã†ã (Eâ†‘é£Ÿâ†“)</option>
                <option value="ã‚€">ã‚€ã˜ã‚ƒã (Eâ†‘ã‚¹â†“)</option>
                <option value="â–¡">ãŒã‚“ã°ã‚Šã‚„ (ç„¡è£œæ­£)</option>
                <option value="â–¡">ã™ãªãŠ (ç„¡è£œæ­£)</option>
                <option value="â–¡">ã¦ã‚Œã‚„ (ç„¡è£œæ­£)</option>
                <option value="â–¡">ãã¾ãã‚Œ (ç„¡è£œæ­£)</option>
                <option value="â–¡">ã¾ã˜ã‚ (ç„¡è£œæ­£)</option>
            </select>

            <button onclick="showBerryPower()">ğŸ’</button>

            <div class="select_button_area">
                <input type="checkbox" id="input_mypoke_speedS"><label for="input_mypoke_speedS">ãŠã¦ã‚¹ãƒ”S</label>
                <input type="checkbox" id="input_mypoke_speedM"><label for="input_mypoke_speedM">ãŠã¦ã‚¹ãƒ”M</label>
                <input type="checkbox" id="input_mypoke_foodS"><label for="input_mypoke_foodS">é£ŸæS</label>
                <input type="checkbox" id="input_mypoke_foodM"><label for="input_mypoke_foodM">é£ŸæM</label>
            </div>

            <div class="select_button_area">
                <input type="checkbox" id="input_mypoke_skillS"><label for="input_mypoke_skillS">ã‚¹ã‚­ãƒ«S</label>
                <input type="checkbox" id="input_mypoke_skillM"><label for="input_mypoke_skillM">ã‚¹ã‚­ãƒ«M</label>
                <input type="checkbox" id="input_mypoke_berryS"><label for="input_mypoke_berryS">ãã®ã¿S</label>
            </div>

            <div id="input_color_buttons">
                <input type="radio" name="color_picker" value="0" id="color_pick_SB" checked><label for="color_pick_SB">â–¡</label>
                <input type="radio" name="color_picker" value="1" id="color_pick_BL"><label for="color_pick_BL">â–¡</label>  
                <input type="radio" name="color_picker" value="2" id="color_pick_SL"><label for="color_pick_SL">â–¡</label>
                <input type="radio" name="color_picker" value="3" id="color_pick_PK"><label for="color_pick_PK">â–¡</label>
                <input type="radio" name="color_picker" value="4" id="color_pick_OR"><label for="color_pick_OR">â–¡</label>
                <input type="radio" name="color_picker" value="5" id="color_pick_RD"><label for="color_pick_RD">â–¡</label>
                <input type="radio" name="color_picker" value="6" id="color_pick_GR"><label for="color_pick_GR">â–¡</label>                   
                <input type="radio" name="color_picker" value="7" id="color_pick_GD"><label for="color_pick_GD">â–¡</label>                    
            </div>

            <button id="input_mypoke_register" style="font-size:1em; vertical-align: middle;" onclick="registerMyPoke();">Myãƒã‚±ãƒ¢ãƒ³ã«è¿½åŠ </button> 
            <button id="input_mypoke_reset" style="font-size:1em; vertical-align: middle;" onclick="resetInputForm();">ãƒªã‚»ãƒƒãƒˆ</button>            
        </div>



        <div id="input_filter_option">
            <div class="select_button_area">
                <input type="checkbox" id="option_poke_30" checked><label for="option_poke_30">Lv30ã‚’è¡¨ç¤º</label>
                <input type="checkbox" id="option_poke_60" checked><label for="option_poke_60">Lv60ã‚’è¡¨ç¤º</label>
            </div>

            <div class="select_button_area">
                <input type="checkbox" onclick="clickMyPokeVisible(this);" id="option_mypoke_visible" checked><label for="option_mypoke_visible">Myãƒã‚±è¡¨ç¤º</label>
                <input type="checkbox" onclick="clickMyPokeVisible(this);" id="option_potential_30" checked><label for="option_potential_30">Lv30äºˆå®š</label>
                <input type="checkbox" onclick="clickMyPokeVisible(this);" id="option_potential_60"><label for="option_potential_60">Lv60äºˆå®š</label>                
            </div>

            <div class="select_button_area">
                <input type="checkbox" id="only_fully_evolved" checked="true"><label for="only_fully_evolved">æœ€çµ‚é€²åŒ–ã®ã¿</label>
           
                é£Ÿææ•°:
                <select id="food_min2" style="width:8em; font-size:1em">
                    <option value=  "0">0å€‹ä»¥ä¸Š</option>
                    <option value= "10">10å€‹ä»¥ä¸Š</option>
                    <option value= "20">20å€‹ä»¥ä¸Š</option>
                    <option value= "30">30å€‹ä»¥ä¸Š</option>
                    <option value= "40">40å€‹ä»¥ä¸Š</option>
                    <option value= "50">50å€‹ä»¥ä¸Š</option>
                    <option value= "60">60å€‹ä»¥ä¸Š</option>
                    <option value= "70">70å€‹ä»¥ä¸Š</option>
                    <option value= "80">80å€‹ä»¥ä¸Š</option>
                    <option value= "90">90å€‹ä»¥ä¸Š</option>
                    <option value="100">100å€‹ä»¥ä¸Š</option>
                </select>
            </div>

        </div>
    
        <div id="food_buttons">
            <img name="ã¨ãã›ã‚“ãƒªãƒ³ã‚´" src="img/food/ã¨ãã›ã‚“ãƒªãƒ³ã‚´.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãƒ¢ãƒ¼ãƒ¢ãƒ¼ãƒŸãƒ«ã‚¯" src="img/food/ãƒ¢ãƒ¼ãƒ¢ãƒ¼ãƒŸãƒ«ã‚¯.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãƒ¯ã‚«ã‚¯ã‚µå¤§è±†" src="img/food/ãƒ¯ã‚«ã‚¯ã‚µå¤§è±†.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã‚ã¾ã„ãƒŸãƒ„" src="img/food/ã‚ã¾ã„ãƒŸãƒ„.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãƒãƒ¡ãƒŸãƒ¼ãƒˆ" src="img/food/ãƒãƒ¡ãƒŸãƒ¼ãƒˆ.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã‚ã£ãŸã‹ã‚¸ãƒ³ã‚¸ãƒ£ãƒ¼" src="img/food/ã‚ã£ãŸã‹ã‚¸ãƒ³ã‚¸ãƒ£ãƒ¼.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã‚ã‚“ã¿ã‚“ãƒˆãƒãƒˆ" src="img/food/ã‚ã‚“ã¿ã‚“ãƒˆãƒãƒˆ.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã¨ãã›ã‚“ã‚¨ãƒƒã‚°" src="img/food/ã¨ãã›ã‚“ã‚¨ãƒƒã‚°.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãƒ”ãƒ¥ã‚¢ãªã‚ªã‚¤ãƒ«" src="img/food/ãƒ”ãƒ¥ã‚¢ãªã‚ªã‚¤ãƒ«.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã»ã£ã“ã‚Šãƒãƒ†ãƒˆ" src="img/food/ã»ã£ã“ã‚Šãƒãƒ†ãƒˆ.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã’ãã‹ã‚‰ãƒãƒ¼ãƒ–" src="img/food/ã’ãã‹ã‚‰ãƒãƒ¼ãƒ–.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãƒªãƒ©ãƒƒã‚¯ã‚¹ã‚«ã‚«ã‚ª" src="img/food/ãƒªãƒ©ãƒƒã‚¯ã‚¹ã‚«ã‚«ã‚ª.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã‚ã˜ã‚ã„ã‚­ãƒã‚³" src="img/food/ã‚ã˜ã‚ã„ã‚­ãƒã‚³.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãµã¨ã„ãªãŒã­ã" src="img/food/ãµã¨ã„ãªãŒã­ã.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãŠã„ã—ã„ã‚·ãƒƒãƒ" src="img/food/ãŠã„ã—ã„ã‚·ãƒƒãƒ.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ãƒ¯ã‚«ã‚¯ã‚µã‚³ãƒ¼ãƒ³" src="img/food/ãƒ¯ã‚«ã‚¯ã‚µã‚³ãƒ¼ãƒ³.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
            <img name="ã‚ã–ã¾ã—ã‚³ãƒ¼ãƒ’ãƒ¼" src="img/food/ã‚ã–ã¾ã—ã‚³ãƒ¼ãƒ’ãƒ¼.png" onclick="addReportOf(this);pokeReport.selectIcon(this);">
        </div>



        <div id="result">
            <table id="result_table">
                <thead>
                    <tr>
                        <th>ãƒã‚±ãƒ¢ãƒ³</th>
                        <th></th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>

            </table>
        </div>


        <div id="mypoke_list">
            <strong>ç™»éŒ²æ¸ˆã¿Myãƒã‚±ãƒ¢ãƒ³:</strong><br>
            <select id="input_mypoke_registered" style="width:15em; font-size:1em; vertical-align: middle;">
            </select>
            <button id="input_mypoke_delete" style="font-size:1em; vertical-align: middle;" onclick="deleteRegisteredMypoke()">å‰Šé™¤</button>
            <div>
                <table id="mypoke_quick_check">
                    <thead>
                        <tr>
                            <th style="width: 20em;">Myãƒã‚±ãƒ¢ãƒ³</th>
                            <th style="width:  9em;">ãã®ã¿ãƒ‘ãƒ¯ãƒ¼</th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>

                </table>
            </div>
        </div>





























        <!--ä»¥ä¸‹ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆ-->
        <script>
            const cookie_mypoke_max = 151;
            let lastClickedFoodIconElement;


            function clickMyPokeVisible(el){
                let opVisible = document.getElementById("option_mypoke_visible");
                let op30 = document.getElementById("option_potential_30");
                let op60 = document.getElementById("option_potential_60");

                if ((el == opVisible) && !opVisible.checked){
                    op30.checked = false;
                    op60.checked = false                   
                }
                else if (!opVisible.checked && el.checked){
                    opVisible.checked = true;
                }
            }


            //å®Ÿéš›ã®ãƒ¬ãƒãƒ¼ãƒˆã¯ã“ã“ã‹ã‚‰ä½œã‚‰ã‚Œã‚‹ã€‚é£Ÿæãƒœã‚¿ãƒ³ã§å®Ÿè¡Œã•ã‚Œã‚‹
            function addReportOf(el = null){
                if (el == null) el = this.lastClickedFoodIconElement;
                if (el == null && this.lastClickedFoodIconElement == null) return;

                this.lastClickedFoodIconElement = el;

                let foodName = el.name;
                let min = document.getElementById('food_min2').value;
                let onlyFullyEvolved = document.getElementById('only_fully_evolved').checked;
                let showLv30 = document.getElementById("option_poke_30").checked;
                let showLv60 = document.getElementById("option_poke_60").checked;

                let t = document.getElementById('result_table');
                t.querySelectorAll("tbody").forEach(b => b.remove());
                t.appendChild(this.pokeReport.createReport(foodName, min, onlyFullyEvolved, showLv30, showLv60));
                
    
                this.insertRegisteredMyPokemons(foodName);

                let json = this.createJsonFromInputForm2(this.document.getElementById('input_mypoke_name').value);
                if (json == null) return;            
                json.backgroundColor = 7;
                this.insertMyPokemon(json, foodName, document.getElementById("option_potential_30").checked, document.getElementById("option_potential_60").checked);
            }


            function showBerryPower(){
                let json = this.createJsonFromInputForm2(this.document.getElementById('input_mypoke_name').value);
                if (json == null) return;

                let res = this.createBerryPowerInfo(json);
                alert(res.mes);
            }



            function createBerryPowerInfo(json){
                berryInfoResult = {};
                let poke = pokedex.getPokemonByName(json.name);
                let oteCount = Math.round(poke.getOtetsudaiCountDay(json.lv, json.speedCharAdj, json.speedSubAdj));                
                let foodOteCount =  Math.round(oteCount * (poke.foodRate * (1 + json.foodCharAdj + json.foodSubAdj)));
                let berryOteCount = oteCount - foodOteCount;
                let berryPower = pokedex.getBerryPowerOf(poke.berry, json.lv);
                let berryPowerDay = Math.round(berryPower * poke.getBerryNum(json.subBerryS) * berryOteCount);
                berryInfoResult.oteCount = oteCount;
                berryInfoResult.foodOteCount = foodOteCount;
                berryInfoResult.berryOteCount = berryOteCount;
                berryInfoResult.berryPower = berryPower;
                berryInfoResult.berryPowerDay = berryPowerDay;
                berryInfoResult.mes =  poke.name + " Lv" + json.lv
                                    + "\nãã®ã¿ãŠã¦ã¤ã ã„: " + berryOteCount + "/" + oteCount
                                    + "\nãã®ã¿ãƒ‘ãƒ¯ãƒ¼: " + berryPower
                                    + "\n1æ—¥: " + berryPowerDay;
                return berryInfoResult;
            }

               
            function registerMyPoke(){
                let json = this.createJsonFromInputForm2(this.document.getElementById('input_mypoke_name').value);
                if (json == null){
                    alert("ç™»éŒ²æƒ…å ±ãŒè¶³ã‚Šã¦ã„ã¾ã›ã‚“ã€‚")
                    return;
                }

                let res = window.confirm(json.name +  "\nã‚’ç™»éŒ²ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ");
                if (res == false) return;

                this.addMyPokeToList(this.createMyPokeOption(json));
                this.listupMyPokeInfo(json);
                this.setMyPokeCookie();
                this.resetInputForm();
            }


            function listupMyPokeInfo(j){
                let body = document.getElementById("mypoke_quick_check").tBodies[0];
                let result = this.createBerryPowerInfo(j);

                let tr = document.createElement("tr");
                tr.setAttribute("value", result.berryPowerDay);
                tr.insertCell().textContent = j.name + "Lv" + j.lv + j.foodCode + " " + getMyPokeIdentifier(j);
                tr.insertCell().textContent = result.berryPowerDay + "(" + result.berryOteCount + "/" + result.oteCount + ")";
                
                let rows = body.children;
                if (rows.length == 0){
                    body.appendChild(tr);
                    return;
                } else {                    
                    for (let i = 0; i < rows.length; i++){
                        let value = rows[i].getAttribute('value');
                        if (value <= result.berryPowerDay){
                            body.insertBefore(tr, rows[i])  ;
                            return;;                      
                        }
                    }
                    body.appendChild(tr);
                }                
            }


            function createMyPokeOption(json){
                let op = document.createElement("option");
                op.value = this.jsonToOptionValue(json);
                op.text = json.name + "Lv" + json.lv + json.foodCode + " " + getMyPokeIdentifier(json);
                return op;
            }


            function getMyPokeIdentifier(j){
                return j.char
                     + (j.subBerryS ? "s" : "")
                     + (j.subSpeedS ? "." : "")
                     + (j.subSpeedM ? ":" : "")
                     + (j.subFoodS ? "f" : "")
                     + (j.subFoodM ? "F" : "")
                     + (j.subSkillS ? "-" : "")
                     + (j.subSkillM ? "+" : "");
            }

                   

            function jsonToOptionValue(json){
                return json.no + ":" + pokeReport.createCookieValueFromJson(json);
            }
            
            
            function addMyPokeToList(op){
                let myList = document.getElementById("input_mypoke_registered");
                if (myList.children.length >= cookie_mypoke_max){
                    alert("Myãƒã‚±ãƒ¢ãƒ³ã¯" + cookie_mypoke_max + "ä½“ã¾ã§ç™»éŒ²å¯èƒ½ã§ã™ã€‚");
                    return false;
                }
                myList.appendChild(op);
                return myList.children.length >= cookie_mypoke_max;
            }
            

            function createJsonFromInputForm2(name){
                if (name == "") return null;       
                let j = {};
                
                j.no = pokedex.getNoByName(name);
                j.name = name;
                j.backgroundColor = Number(document.querySelector("#input_color_buttons input:checked").value);
                j.lv = Number(this.document.getElementById('input_mypoke_lv').value);
                j.foodCode = this.getMyPokeFoodCode();                
                j.char = document.getElementById("input_mypoke_char").value;
                if (j.char == "") return null;

                j.subBerryS = document.getElementById("input_mypoke_berryS").checked;
                j.subSpeedS = document.getElementById("input_mypoke_speedS").checked;
                j.subSpeedM = document.getElementById("input_mypoke_speedM").checked;
                j.subFoodS = document.getElementById("input_mypoke_foodS").checked;
                j.subFoodM = document.getElementById("input_mypoke_foodM").checked;

                j.subSkillS = document.getElementById("input_mypoke_skillS").checked;
                j.subSkillM = document.getElementById("input_mypoke_skillM").checked;

                let charBit = this.pokeReport.getCharacteristicNumOf(j.char);
                pokeReport.setAdjustValues(j);
                return j;  
            }






    



            //Myãƒã‚±ãƒ¢ãƒ³é–¢é€£
            function insertRegisteredMyPokemons(food){
                if (!document.getElementById("option_mypoke_visible").checked) return;
                let options = document.getElementById("input_mypoke_registered").children;

                for (let i = 0; i < options.length; i++){
                    let json = this.cookieValueToJson(options[i].value);
                    this.insertMyPokemon(json, food, document.getElementById("option_potential_30").checked, document.getElementById("option_potential_60").checked);
                }
            }


            function cookieValueToJsonList(c){
                let ccc = c.split("/");
                let jss = [];

                for (let i = 0; i < ccc.length; i++){
                    jss.push(this.cookieValueToJson(ccc[i]));
                }
                return jss;
            }

            function cookieValueToJson(str){
                return pokeReport.createJsonFromCookieValue(str);
            }


            function insertMyPokemon(json, food, showPotential30 = false, showPotential60 = false){
                let poke = pokedex.getPokemonByName(json.name);        
                

                if (json.lv < 30 && showPotential30){
                    let p30comb = new FoodCombination(poke, 30, poke.getOtetsudaiCountDay(30, json.speedCharAdj, json.speedSubAdj), json.foodCode, json.foodCharAdj + json.foodSubAdj);

                    if (p30comb.contains(food)) this.addMyPokemonRow(poke, food, p30comb, this.numToColorCode(4));
                }
                if (json.lv < 60 && showPotential60){
                    let p60comb = new FoodCombination(poke, 60, poke.getOtetsudaiCountDay(60, json.speedCharAdj, json.speedSubAdj), json.foodCode, json.foodCharAdj + json.foodSubAdj);
                    if (p60comb.contains(food)) this.addMyPokemonRow(poke, food, p60comb, this.numToColorCode(5));                  
                }

                let comb = new FoodCombination(poke, json.lv, poke.getOtetsudaiCountDay(json.lv, json.speedCharAdj, json.speedSubAdj), json.foodCode, json.foodCharAdj + json.foodSubAdj);
                if (!comb.contains(food))   return;
                this.addMyPokemonRow(poke, food, comb, this.numToColorCode(json.backgroundColor));
            }


            function addMyPokemonRow(poke, food, comb, backgroundColor){
                let tr = document.createElement('tr');
                tr.style.backgroundColor = backgroundColor;
                comb.insertResultTo(tr, food, poke);

                let tb = document.getElementById('result_table').tBodies[0];
                let rows = tb.children;

                let target = comb.getExpectionOf(food);
                for (let i = 0; i < rows.length; i++){
                    let value = rows[i].children[1].getAttribute('value');
                    if (value <= target){
                        tb.insertBefore(tr, rows[i]);
                        return;
                    }
                }
                tb.appendChild(tr);
            }


            function numToColorCode(n){
                switch(n){
                    case 0: return "#CCDDFF"; break;
                    case 1: return "#77AAFF"; break;
                    case 2: return "#DDDDDD"; break;
                    case 3: return "#FFDDDD"; break;                    
                    case 4: return "#FFBB77"; break;                    
                    case 5: return "#FFA0A0"; break;
                    case 6: return "#BBFFBB"; break;
                    case 7: return "#FFFFCC"; break;                    
                    default: return "#FF4444"
                }
            }





            function getMyPokeFoodCode(){
                return document.getElementById("input_mypoke_food_1").getAttribute("code")
                     + document.getElementById("input_mypoke_food_2").getAttribute("code")
                     + document.getElementById("input_mypoke_food_3").getAttribute("code");
            }




            //ã‚¯ãƒƒã‚­ãƒ¼é–¢é€£(ç™»éŒ²)
            function setMyPokeCookie(){
                let options= document.getElementById("input_mypoke_registered").children;
                let values = [];
                for (let i = 0; i < options.length; i++){
                    values.push(options[i].value);
                }

                setCookie("myPokeList", values.join("/"), 30);
            }     





            //ã‚¯ãƒƒã‚­ãƒ¼é–¢é€£(å‘¼ã³å‡ºã—)
            function setMypokesToListFromCookie(){
                let c = getCookie("myPokeList")
                if (c == null) return; 

                let jss = cookieValueToJsonList(c);
                if (jss == null) return;

                for (let i = 0; i < jss.length; i++){
                    this.listupMyPokeInfo(jss[i]);
                    let maxFlag = this.addMyPokeToList(this.createMyPokeOption(jss[i]));
                    if (maxFlag){
                        alert("é™ç•Œ");
                        return;
                    }            
                }
            }   












            //ãƒ­ãƒ¼ãƒ‰æ™‚ã€ãƒœã‚¿ãƒ³ãªã©ã‹ã‚‰ç›´æ¥å‘¼ã³å‡ºã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã‚‚ã®
            function setFoodImages(el){
                let poke = pokedex.getPokemonByName(el.value);
                if (poke == null){
                    return;
                }
                
                let img1 = document.getElementById('input_mypoke_food_1');
                let img2 = document.getElementById('input_mypoke_food_2');
                let img3 = document.getElementById('input_mypoke_food_3');
                this.setFoodImageOnImgEl(img1, poke, 1);
                this.setFoodImageOnImgEl(img2, poke, 2);
                this.setFoodImageOnImgEl(img3, poke, 3);
            }


            function setFoodImageOnImgEl(el, poke, max){
                let values = poke.getAllFoodNames();
                let value = values[0];
                el.setAttribute("values", values.slice(0, max).join(","));
                el.setAttribute("value", value);
                el.setAttribute("code", "A")
                this.toggleFood(el, 0);
            }


            function toggleFood(el, setIndex = -1){
                let values = el.getAttribute("values").split(",");
                let index = values.indexOf(el.getAttribute("value"));
                let next = (setIndex != -1) ? setIndex
                          : ((index + 1) >= values.length) ? 0 : index + 1;
                
                el.src = el.getAttribute("dir") + values[next] + ".png";
                el.setAttribute("value", values[next]);
                el.setAttribute("code", String.fromCharCode(65 + next));               
            }


            function resetInputForm(){
                let res = window.confirm("å…¥åŠ›æƒ…å ±ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ");
                if (res == false) return;

                document.getElementById('input_mypoke_name').selectedIndex = 0;
                document.getElementById('input_mypoke_lv').selectedIndex = 29;
                document.getElementById("input_mypoke_char").selectedIndex = 0;
                document.getElementById("input_mypoke_speedS").checked = false;
                document.getElementById("input_mypoke_speedM").checked = false;
                document.getElementById("input_mypoke_foodS").checked = false;
                document.getElementById("input_mypoke_foodM").checked = false;
                document.getElementById("input_mypoke_skillS").checked = false;
                document.getElementById("input_mypoke_skillM").checked = false;
                document.getElementById("input_mypoke_berryS").checked = false;
            }




            function deleteRegisteredMypoke(){
                let list = document.getElementById("input_mypoke_registered");
                if (list.children.length == 0) return;
                if (list.selectedOptions.length != 1){
                    alert("é …ç›®ã¯ä¸€ã¤ã ã‘ãˆã‚‰ã‚“ã§ãã ã•ã„ã€‚");
                    return;
                }

                let op = list.children[list.selectedIndex];                
                let res = window.confirm(op.textContent +  "\nã‚’å‰Šé™¤ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ");
                if (res == false) return;

                list.removeChild(op);
                this.setMyPokeCookie();
            }




            function characteristicConv(v){
                switch(v){
                    case "å¯‚": return "sb"; break;
                    case "ã„": return "ij"; break;
                    case "ã‚„": return "yn"; break;
                    case "å‹‡": return "yu"; break;
                    case "ãš": return "zb"; break;
                    case "ã‚": return "wp"; break;
                    case "èƒ½": return "nt"; break;
                    case "ã®": return "nn"; break;
                    case "ã²": return "hk"; break;
                    case "ãŠ": return "or"; break;
                    case "ã†": return "uk"; break;
                    case "å†·": return "ri"; break;
                    case "ç©": return "od"; break;
                    case "å¤§": return "on"; break;
                    case "æ…": return "sn"; break;
                    case "ãª": return "nm"; break;
                    case "è‡†": return "ok"; break;
                    case "ã›": return "sk"; break;
                    case "é™½": return "yu"; break;
                    case "ã‚€": return "mj"; break;
                    case "â–¡": return "xx"; break;

                    case "sb": return "å¯‚"; break;
                    case "ij": return "ã„"; break;
                    case "yn": return "ã‚„"; break;
                    case "yu": return "å‹‡"; break;
                    case "zb": return "ãš"; break;
                    case "wp": return "ã‚"; break;
                    case "nt": return "èƒ½"; break;
                    case "nn": return "ã®"; break;
                    case "hk": return "ã²"; break;
                    case "or": return "ãŠ"; break;
                    case "uk": return "ã†"; break;
                    case "ri": return "å†·"; break;
                    case "od": return "ç©"; break;
                    case "on": return "å¤§"; break;
                    case "sn": return "æ…"; break;
                    case "nm": return "ãª"; break;
                    case "ok": return "è‡†"; break;
                    case "sk": return "ã›"; break;
                    case "yu": return "é™½"; break;
                    case "mj": return "ã‚€"; break;
                    case "xx": return "â–¡"; break;
                    default: return "--";
                }                
            }

       



            function initializePokeList(){
                if (this.selectBoxInitialized) return;

                let list = document.getElementById('input_mypoke_name');
                let blankOp = document.createElement('option');
                blankOp.text = "";
                blankOp.value = "";
                list.appendChild(blankOp);

                let names = pokemons.map(p => p.name).sort();
                for (let i = 0; i < names.length; i++){
                    let op = document.createElement('option');                    
                    op.text = names[i];
                    op.value = names[i];   
                    list.appendChild(op);                 
                }

                list = document.getElementById('input_mypoke_lv');
                blankOp = document.createElement('option');


                for (let i = 1; i <= 60; i++){
                    let op = document.createElement('option');                    
                    op.text = i;
                    op.value = i;   
                    list.appendChild(op);                 
                }
                list.selectedIndex = 29;

                this.selectBoxInitialized = true;
            }

            //ãƒ­ãƒ¼ãƒ‰æ™‚ã®ã‚¤ãƒ™ãƒ³ãƒˆ
            window.onload = ()=>{
                this.pokedex = new Pokedex();
                this.pokemons = pokedex.pokemons;
                this.pokeReport = new PokeReport(this.pokedex);
                this.pokeReport.initialize();
                this.selectBoxInitialized = false;
                setMypokesToListFromCookie();
            }
        </script>
    </body>

</html>
